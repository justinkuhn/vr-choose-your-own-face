<html>
<head>
  <title>Link traverse</title>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
  <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
</head>
<body>
  <a-scene id="vr-scene" cursor="rayOrigin: mouse">    
  </a-scene>  
</body>
<script>
  const DATA = {
    scenes: [
      {
        id: "scene-1",
        elements: [
          {
            id: "env",
            attrs: [
              {
                attr: "environment",
                value: "skyType: gradient;" + 
                  "grid: none;" +
                  "skyColor: #222222;" + 
                  "horizonColor: #111111;" +
                  "dressingScale: 3;" +
                  "dressing: trees;" +
                  "dressingColor: #ff6538;" +
                  "dressingAmount: 250;" +
                  "groundColor: #0d4838;" +
                  "groundColor2: #0d4838;" +
                  "shadow: true;" +
                  "ground: hills;" +
                  "groundYScale: 2;" +
                  "playArea: 0.2"
              }
            ]
          }, 
          {
            id: "box",
            attrs: [
              {
                attr: "geometry",
                value: "primitive: box"
              }, 
              {
                attr: "material",
                value: "color: pink"
              },
              {
                attr: "position",
                value: "-1 1 -2"
              }
            ]
          }
        ]
      },
      {
        id: "scene-2",
        elements: [
          {
            id: "env",
            attrs: [
              {
                attr: "environment",
                value: "skyType: gradient;" + 
                  "grid: none;" +
                  "skyColor: #555555;" + 
                  "horizonColor: #111111;" +
                  "dressingScale: 3;" +
                  "dressing: trees;" +
                  "dressingColor: #ff6538;" +
                  "dressingAmount: 250;" +
                  "groundColor: #0d4838;" +
                  "groundColor2: #0d4838;" +
                  "shadow: true;" +
                  "ground: hills;" +
                  "groundYScale: 2;" +
                  "playArea: 0.2"
              }
            ]
          }, 
          {
            id: "box",
            attrs: [
              {
                attr: "geometry",
                value: "primitive: box"
              }, 
              {
                attr: "material",
                value: "color: blue"
              },
              {
                attr: "position",
                value: "-1 2 -2"
              }
            ]
          }
        ]
      }
    ]
  };


  // Initialize specified scene from data 
  function initScene(index) {
    console.log("Init scene");
    const sceneContents = d3.select("#vr-scene")
      .selectAll(".scene-contents")
      .data(DATA.scenes[index].elements);

    sceneContents
      .enter()
      .append("a-entity")
      .classed("scene-contents", true)
      .attr("id", function(d) {
        return d.id;
      })
    .merge(sceneContents)
      .each(function(d) {
        for (let i = 0; i < d.attrs.length; i++) {
          d3.select(this)
            .attr(d.attrs[i].attr, d.attrs[i].value);
        }
      });

    sceneContents
      .exit()
      .remove();


  }

  initScene(0);

  setTimeout(function() { initScene(1); }, 4000);
</script>
</html>
